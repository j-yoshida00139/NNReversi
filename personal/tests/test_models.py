import pytest
from mixer.backend.django import mixer
from personal.models import BestMove

pytestmark = pytest.mark.django_db


class Test_BestMove:
	def test_create(self):
		obj = mixer.blend('personal.BestMove')
		assert obj.pk == 1, 'Should create a BestMove instance'

	def test_encodeToNNArrange(self):
		gameArrange = [
			[0, 1, 2, 0, 1, 2, 0, 1],
			[2, 0, 1, 2, 0, 1, 2, 0],
			[1, 2, 0, 1, 2, 0, 1, 2],
			[0, 1, 2, 0, 1, 2, 0, 1],
			[2, 0, 1, 2, 0, 1, 2, 0],
			[1, 2, 0, 1, 2, 0, 1, 2],
			[0, 1, 2, 0, 1, 2, 0, 1],
			[2, 0, 1, 2, 0, 1, 2, 0],
		]
		nnArrange_1 = [
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0],
			[1.0], [0.0], [0.0]
		]
		nnArrange_2 = [
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0], [0.0], [0.0], [1.0], [0.0], [1.0], [0.0],
			[1.0], [0.0], [0.0]
		]
		assert BestMove.encodeToNNArrange(gameArrange, playerColor=1) == nnArrange_1
		assert BestMove.encodeToNNArrange(gameArrange, playerColor=2) == nnArrange_2

	def test_encodeDBArrange(self):
		gameArrange = [
			0, 1, 2, 0, 1, 2, 0, 1,
			2, 0, 1, 2, 0, 1, 2, 0,
			1, 2, 0, 1, 2, 0, 1, 2,
			0, 1, 2, 0, 1, 2, 0, 1,
			2, 0, 1, 2, 0, 1, 2, 0,
			1, 2, 0, 1, 2, 0, 1, 2,
			0, 1, 2, 0, 1, 2, 0, 1,
			2, 0, 1, 2, 0, 1, 2, 0
		]
		correctFirstInt = 66032381159471
		correctLastInt = 3939357278671015
		firstInt, lastInt = BestMove.encodeToDBArrange(gameArrange=gameArrange)
		assert firstInt == correctFirstInt
		assert lastInt == correctLastInt
